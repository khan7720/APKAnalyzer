<!DOCTYPE html><?xml version="1.0" encoding="UTF-8"?>
<html lang="zh-CN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <link rel="icon" href="./css/logo.png"/>
    <title>
      分析结果
    </title>
    <!--  
    <link href="https://fastly.jsdelivr.net/npm/@bootcss/v3.bootcss.com@1.0.35/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fastly.jsdelivr.net/npm/@bootcss/v3.bootcss.com@1.0.35/examples/grid/grid.css" rel="stylesheet">
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5.3.2/dist/echarts.min.js"></script> 
-->    <link href="./bootstrap/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="./css/grid.css" rel="stylesheet"/>
    <script type="text/javascript" src="./echarts.js">
    </script>
  </head>
  <body onload="checkTF()">
    <script type="text/javascript">
//<![CDATA[

	  	function checkTF(){	if (2==0) document.getElementById('container6').remove();     }
	  
//]]>
    </script>
    <div class="container">
      <div class="page-header" style="display: inline-block;">
        <h1>
          分析结果    
          <span class="label label-success">
            Report
          </span>
        </h1>
        <p class="lead">
          通过本系统后台分析工具FastDroid所分析生成的多维度报告   
          <span class="glyphicon glyphicon-check" aria-hidden="true">
          </span>
        </p>
      </div>
      <div style="display: inline-block;margin-left:300px">
        <a href="/TestProject/DownloadServlet?filename=ApplicationLifecycle2.apk&amp;currentID=50">
          <input type="button" value="下载报告" class="btn btn-lg btn-primary" style="display: inline-block;"/>
        </a>
      </div>
      <h3>
        APK基本信息
      </h3>
      <p>
        了解APK的基本信息，包括
        <strong>
          代码量、权限、API及污染流
        </strong>
        等基础数据。
      </p>
      <table class="table table-striped">
        <tbody>
          <tr>
            <td>
              应用名称
            </td>
            <td>
              ApplicationLifecycle2.apk
            </td>
          </tr>
          <tr>
            <td>
              APK大小
            </td>
            <td>
              180 KB
            </td>
          </tr>
          <tr>
            <td>
              代码数量
            </td>
            <td>
              93 行
            </td>
          </tr>
          <tr>
            <td>
              CFG构造时间
            </td>
            <td>
              2.04269 S
            </td>
          </tr>
          <tr>
            <td>
              FastDroid分析时间
            </td>
            <td>
              0.0391528 S
            </td>
          </tr>
          <tr>
            <td>
              已分析类
            </td>
            <td>
              12
            </td>
          </tr>
          <tr>
            <td>
              已分析方法
            </td>
            <td>
              76
            </td>
          </tr>
          <tr>
            <td>
              已分析语句
            </td>
            <td>
              45
            </td>
          </tr>
          <tr>
            <td>
              污染流数
            </td>
            <td>
              1
            </td>
          </tr>
          <tr>
            <td>
              可能的污染流数
            </td>
            <td>
              0
            </td>
          </tr>
          <tr>
            <td>
              开始分析时间
            </td>
            <td>
              2022-05-11 23:55:29
            </td>
          </tr>
          <tr>
            <td>
              权限
            </td>
            <td>
              2
            </td>
          </tr>
          <tr>
            <td>
              API
            </td>
            <td>
              2
            </td>
          </tr>
        </tbody>
      </table>
      <h3>
        权限信息
      </h3>
      <p>
        了解该Android应用的权限信息，
        <strong>
          可分为安装时权限、运行时权限和特殊权限。
        </strong>
        按照风险可划分为低中高三级别。
      </p>
      <table class="table table-striped">
        <tbody>
          <tr>
            <td class="info" width="10%">
              序号
            </td>
            <td class="info" width="60%">
              权限名称
            </td>
            <td class="info" width="30%">
              权限等级
            </td>
          </tr>
        </tbody>
      </table>
      <table id="plist" class="table table-striped">
        <tbody>
          <tr>
            <td>
              1
            </td>
            <td>
              SEND_SMS
            </td>
            <td>
              dangerous
            </td>
          </tr>
          <tr>
            <td>
              2
            </td>
            <td>
              READ_PHONE_STATE
            </td>
            <td>
              dangerous
            </td>
          </tr>
        </tbody>
      </table>
      <script>
//<![CDATA[

		    var strs='';
		    
		    	var str='';
		    	str+='<td>'+'1'+'</td>';
		    	str+='<td>'+'SEND_SMS'+'</td>';
		    	str+='<td>'+'dangerous'+'</td>';
				strs+='<tr>'+str+'</tr>';
		    
		    	var str='';
		    	str+='<td>'+'2'+'</td>';
		    	str+='<td>'+'READ_PHONE_STATE'+'</td>';
		    	str+='<td>'+'dangerous'+'</td>';
				strs+='<tr>'+str+'</tr>';
		    
		    document.getElementById("plist").innerHTML=strs;
	      
//]]>
      </script>
      <h3>
        API信息
      </h3>
      <p>
        了解该Android应用的API信息，
        <strong>
          包括名称、调用函数和处于污染流中的什么位置
        </strong>
        。
      </p>
      <table class="table table-striped">
        <tbody>
          <tr>
            <td class="info" width="5%">
              序号
            </td>
            <td class="info" width="70%">
              API名称
            </td>
            <td class="info" width="19%">
              调用函数
            </td>
            <td class="info" width="6%">
              TF位置
            </td>
          </tr>
        </tbody>
      </table>
      <table id="alist" class="table table-striped">
        <tbody>
          <tr>
            <td>
              1
            </td>
            <td>
              android.telephony.TelephonyManager: java.lang.String getDeviceId()
            </td>
            <td>
              de.ecspride.ApplicationLifecyle2, void onCreate()
            </td>
            <td>
              Source
            </td>
          </tr>
          <tr>
            <td>
              2
            </td>
            <td>
              android.telephony.SmsManager: void sendTextMessage(java.lang.String,java.lang.String,java.lang.String,android.app.PendingIntent,android.app.PendingIntent)
            </td>
            <td>
              de.ecspride.ApplicationLifecyle2, void onLowMemory()
            </td>
            <td>
              Sink
            </td>
          </tr>
        </tbody>
      </table>
      <script>
//<![CDATA[

	    var strs='';
	    
	    	var str='';
	    	str+='<td>'+'1'+'</td>';
	    	str+='<td>'+'android.telephony.TelephonyManager: java.lang.String getDeviceId()'+'</td>';
	    	str+='<td>'+'de.ecspride.ApplicationLifecyle2, void onCreate()'+'</td>';
	    	str+='<td>'+'Source'+'</td>';
			strs+='<tr>'+str+'</tr>';
	    
	    	var str='';
	    	str+='<td>'+'2'+'</td>';
	    	str+='<td>'+'android.telephony.SmsManager: void sendTextMessage(java.lang.String,java.lang.String,java.lang.String,android.app.PendingIntent,android.app.PendingIntent)'+'</td>';
	    	str+='<td>'+'de.ecspride.ApplicationLifecyle2, void onLowMemory()'+'</td>';
	    	str+='<td>'+'Sink'+'</td>';
			strs+='<tr>'+str+'</tr>';
	    
	    document.getElementById("alist").innerHTML=strs;
      
//]]>
      </script>
      <h3>
        图表展示
        <span class="label label-success">
          Chart
        </span>
      </h3>
    </div>
    <!-- /container -->    <div id="container1" style="height: 300px; width: 300px; margin: 0 auto; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0, 0, 0, 0); position: relative;" _echarts_instance_="ec_1653438428307">
      <div style="position:relative;width:300px;height:300px;padding:0;margin:0;border-width:0;">
        <canvas style="position: absolute; left: 0px; top: 0px; width: 300px; height: 300px; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0; margin: 0; border-width: 0;" data-zr-dom-id="zr_0" width="300" height="300"/>
      </div>
      <div class="">
      </div>
    </div>
    <div style="text-align: center;">
      <div id="container2" style="height: 300px; width: 300px; margin: 0 auto; display: inline-block; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0,0,0,0);" _echarts_instance_="ec_1653438428308">
        <div style="position:relative;width:300px;height:300px;padding:0;margin:0;border-width:0;">
          <canvas style="position: absolute; left: 0px; top: 0px; width: 300px; height: 300px; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0; margin: 0; border-width: 0;" data-zr-dom-id="zr_0" width="300" height="300"/>
        </div>
      </div>
      <div id="container3" style="height: 300px; width: 300px; margin: 0 auto; display: inline-block; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0,0,0,0);" _echarts_instance_="ec_1653438428309">
        <div style="position:relative;width:300px;height:300px;padding:0;margin:0;border-width:0;">
          <canvas style="position: absolute; left: 0px; top: 0px; width: 300px; height: 300px; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0; margin: 0; border-width: 0;" data-zr-dom-id="zr_0" width="300" height="300"/>
        </div>
      </div>
    </div>
    <div style="text-align: center;">
      <div id="container4" style="height: 300px; width: 300px; margin: 0 auto; display: inline-block; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0,0,0,0);" _echarts_instance_="ec_1653438428310">
        <div style="position:relative;width:300px;height:300px;padding:0;margin:0;border-width:0;">
          <canvas style="position: absolute; left: 0px; top: 0px; width: 300px; height: 300px; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0; margin: 0; border-width: 0;" data-zr-dom-id="zr_0" width="300" height="300"/>
        </div>
      </div>
      <div id="container5" style="height: 300px; width: 300px; margin: 0 auto; display: inline-block; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0,0,0,0);" _echarts_instance_="ec_1653438428311">
        <div style="position:relative;width:300px;height:300px;padding:0;margin:0;border-width:0;">
          <canvas style="position: absolute; left: 0px; top: 0px; width: 300px; height: 300px; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0; margin: 0; border-width: 0;" data-zr-dom-id="zr_0" width="300" height="300"/>
        </div>
      </div>
    </div>
    <div id="container6" style="height: 700px; width: 700px; margin: 0 auto; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0, 0, 0, 0); position: relative;" _echarts_instance_="ec_1653438428312">
      <div style="position:relative;width:700px;height:700px;padding:0;margin:0;border-width:0;">
        <canvas style="position: absolute; left: 0px; top: 0px; width: 700px; height: 700px; webkit-user-select: none; user-select: none; webkit-tap-highlight-color: rgba(0, 0, 0, 0); padding: 0; margin: 0; border-width: 0;" data-zr-dom-id="zr_0" width="700" height="700"/>
      </div>
      <div class="">
      </div>
    </div>
    <script type="text/javascript">
//<![CDATA[

var dom = document.getElementById("container1");
var myChart = echarts.init(dom);
var app = {};

var option;



option = {
  title:{
	  show:true,
	  text:'权限信息',
	  x:'center'
  },
  tooltip: {
    trigger: 'item'
  },
  legend: {
    top: '5%',
    left: 'center'
  },
  series: [
    {
      name: '权限信息',
      type: 'pie',
      radius: ['40%', '70%'],
      avoidLabelOverlap: false,
      animation:false,
      itemStyle: {
        borderRadius: 10,
        borderColor: '#fff',
        borderWidth: 2
      },
      label: {
        show: false,
        position: 'center'
      },
      emphasis: {
        label: {
          show: true,
          fontSize: '40',
          fontWeight: 'bold'
        }
      },
      labelLine: {
        show: false
      },
      data: [
        { value: 2, name: '危险权限',itemStyle:{color:'red'} },
        { value: 0, name: '正常权限',itemStyle:{color:'green'} },
        { value: 0, name: '特殊权限',itemStyle:{color:'yellow'} },
        { value: 0, name: '其他权限',itemStyle:{color:'grey'} },
      ]
    }
    
    
  ]
};

if (option && typeof option === 'object') {
    myChart.setOption(option);
}

        
//]]>
    </script>
    <script type="text/javascript">
//<![CDATA[

var dom = document.getElementById("container2");
var myChart = echarts.init(dom);
var app = {};

var option;



option = {
 title:{
	  show:true,
	  text:'apk大小',
	  x:'center'
  },
  xAxis: {
    type: 'category',
    data: ['此apk大小', '平均大小']
  },
  yAxis: {
    type: 'value'
  },
  series: [
    {
      data: [180, 177],
      type: 'bar',
      showBackground: true,
      animation:false,
      backgroundStyle: {
        color: 'rgba(180, 180, 180, 0.2)'
      },
      itemStyle:{
          normal:{
              color:'#4ad2ff'
          }
      },
      label:{
    	  show:true
      }
    }
  ]
};

if (option && typeof option === 'object') {
    myChart.setOption(option);
}

        
//]]>
    </script>
    <script type="text/javascript">
//<![CDATA[

var dom = document.getElementById("container3");
var myChart = echarts.init(dom);
var app = {};

var option;



option = {
 title:{
	  show:true,
	  text:'代码数量',
	  x:'center'
  },
  xAxis: {
    type: 'category',
    data: ['此apk代码量', '平均代码量']
  },
  yAxis: {
    type: 'value'
  },
  series: [
    {
      data: [93, 117],
      type: 'bar',
      showBackground: true,
      animation:false,
      backgroundStyle: {
        color: 'rgba(180, 180, 180, 0.2)'
      },
      itemStyle:{
          normal:{
              color:'#ffb6c1'
          }
      },
      label:{
    	  show:true
      }
    }
  ]
};

if (option && typeof option === 'object') {
    myChart.setOption(option);
}

        
//]]>
    </script>
    <script type="text/javascript">
//<![CDATA[

var dom = document.getElementById("container4");
var myChart = echarts.init(dom);
var app = {};

var option;



option = {
 title:{
	  show:true,
	  text:'CFG构造时间',
	  x:'center'
  },
  xAxis: {
    type: 'category',
    data: ['本次时间', '平均时间']
  },
  yAxis: {
    type: 'value'
  },
  series: [
    {
      data: [2.04269, 2.11952],
      type: 'bar',
      showBackground: true,
      animation:false,
      backgroundStyle: {
        color: 'rgba(180, 180, 180, 0.2)'
      },
      label:{
    	  show:true
      }
    }
  ]
};

if (option && typeof option === 'object') {
    myChart.setOption(option);
}

        
//]]>
    </script>
    <script type="text/javascript">
//<![CDATA[

var dom = document.getElementById("container5");
var myChart = echarts.init(dom);
var app = {};

var option;



option = {
 title:{
	  show:true,
	  text:'FastDroid分析时间',
	  x:'center'
  },
  xAxis: {
    type: 'category',
    data: ['本次时间', '平均时间']
  },
  yAxis: {
    type: 'value'
  },
  series: [
    {
      data: [0.0391528, 0.03308],
      type: 'bar',
      showBackground: true,
      animation:false,
      backgroundStyle: {
        color: 'rgba(180, 180, 180, 0.2)'
      },
      label:{
    	  show:true
      }
    }
  ]
};

if (option && typeof option === 'object') {
    myChart.setOption(option);
}

        
//]]>
    </script>
    <script type="text/javascript">
//<![CDATA[

var dom = document.getElementById("container6");
var myChart = echarts.init(dom);
var app = {};

var option;



option = {
  title: {
    text: '污染流图',
    x:'center'
  },
  tooltip: {},
  animation: false,

  series: [
    {
      type: 'graph',
      layout: 'none',
      symbol: 'Rect',
      color:'none',
      roam: false,
      label: {
        show: true
      },
      edgeSymbol: ['circle', 'arrow'],
      edgeSymbolSize: [4, 10],
      edgeLabel: {
        fontSize: 20
      },
      itemStyle: {
      borderColor: "black",
      borderWidth: 2
      },
      data: [
        {
          id:'source',
          name: 'Source',
          symbol: 'circle',
          x: 300,
          y: 700,
          symbolSize: 50,
        },
        {id:'sink',
          name: 'Sink',
          symbol: 'circle',
          x: 1000,
          y: -150,
          symbolSize: 50
        },
        {id:'api1',
          name:' java.lang.String getDeviceId()',
          x: 400,
          y: 500,
          symbolSize: [150,60]
        },
        {id:'permission1',
          name: 'READ_PHONE_STATE',
          x: 500,
          y: 700,
          symbolSize: [100,50],
          itemStyle: {
          borderColor: "red",
          borderWidth: 3
          }
        },
        {id:'permission2',
          name: 'SEND_SMS',
          x: 800,
          y: -150,
          symbolSize: [100,50],
          itemStyle: {
          borderColor: "red",
          borderWidth: 3
          }
        },
        {id:'api2',
          name: ' void sendTextMessage()',
          x: 900,
          y: 50,
          symbolSize: [150,60]
        },
        {id:'caller1',
          name: ' void onCreate()',
          x: 400,
          y: 50,
          symbolSize: [150,60]
        },
        {id:'caller2',
          name: ' void onLowMemory()',
          x: 900,
          y: 500,
          symbolSize: [150,60]
        }
      ],
      // links: [],
      links: [
        {
          source: 'source',
          target: 'api1',
          lineStyle: {
            curveness: 0.2
          }
        },
        {
          source:'caller2',
          target: 'api2',
        },
        {
          source: 'caller1',
          target: 'api1',
        },
        {
          source: 'caller1',
          target: 'caller2',
          label: {
            show: true
          },
          lineStyle: {
            curveness: -0.2
          }
        },
         {
          source: 'api2',
          target: 'sink',
          lineStyle: {
            curveness: -0.2
          }
        },
          {
          source: 'permission1',
          target: 'api1',
        },
          {
          source: 'permission2',
          target: 'api2',
        }
      ],
      lineStyle: {
        opacity: 0.9,
        width: 2,
        curveness: 0
      }
    }
  ]
};


if (option && typeof option === 'object') {
    myChart.setOption(option);
}

        
//]]>
    </script>
    <div id="edge-translate-notifier-container" class="edge-translate-notifier-center">
    </div>
  </body>
</html>
